

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Basic arithmetic &mdash; tmech  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Numerical differentiation" href="numerical_diff.html" />
    <link rel="prev" title="Tensors as arrays" href="tensor_as_array.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> tmech
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">INSTALLATION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<p class="caption"><span class="caption-text">USAGE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="expression.html">Expressions and lazy evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensor_as_array.html">Tensors as arrays</a></li>
</ul>
<p class="caption"><span class="caption-text">QUICK REFERENCE TMECH</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Basic arithmetic</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#addition">Addition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subtraction">Subtraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#single-contraction">Single contraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scalar-update">Scalar update</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#basis-rearrangement">Basis rearrangement</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-basis-rearrangement">General basis rearrangement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transposition">Transposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#left-basis-transposition">Left basis transposition</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#outer-product">Outer product</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-outer-product">General outer product</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dyadic-product">Dyadic product</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lower-dyadic-product">Lower dyadic product</a></li>
<li class="toctree-l2"><a class="reference internal" href="#upper-dyadic-product">Upper dyadic product</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#inner-product">Inner product</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-inner-product">General inner product</a></li>
<li class="toctree-l2"><a class="reference internal" href="#double-contraction">Double contraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fourth-contraction">Fourth contraction</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#invers-of-a-tensor">Invers of a tensor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#second-order-tensors-and-fourth-order-tensors-with-minior-symmetry">Second order tensors and fourth order tensors with minior-symmetry</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fully-anisotropic-tensors">Fully anisotropic tensors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#volumetric-and-deviatoric-parts">Volumetric and deviatoric parts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#volumetric-part">Volumetric part</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deviatoric-part">Deviatoric part</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#symmetric-and-skew-symmetric-parts">Symmetric and skew-symmetric parts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#symmetric-part">Symmetric part</a></li>
<li class="toctree-l2"><a class="reference internal" href="#skew-symmetric-part">Skew-symmetric part</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#isotropic-tensor-functions">Isotropic tensor functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-function">General function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#square-root">Square root</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exponential-map">Exponential map</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logarithmic-map">Logarithmic map</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#positive-negative-decomposition">Positive-negative decomposition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-method">General method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#only-positive-part">Only positive part</a></li>
<li class="toctree-l2"><a class="reference internal" href="#only-negative-part">Only negative part</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#eigen-decomposition">Eigen-decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sign-decomposition">Sign decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="#polar-decomposition">Polar decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id1">Exponential map</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical_diff.html">Numerical differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="compare_operators.html">Compare Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="adaptor.html">Adapting pointers of raw memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="convert_to_voigt.html">Converting to Voigt’s notation</a></li>
</ul>
<p class="caption"><span class="caption-text">API REFERENCE TMECH</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api_tmech.html">Tensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_tmech.html#wrapper">Wrapper</a></li>
</ul>
<p class="caption"><span class="caption-text">API REFERENCE SYMDIFF</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api_symdiff.html">Variable</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_symdiff.html#wrappers">Wrappers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tmech</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Basic arithmetic</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/tensor_functions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="basic-arithmetic">
<h1>Basic arithmetic<a class="headerlink" href="#basic-arithmetic" title="Permalink to this headline">¶</a></h1>
<div class="section" id="addition">
<h2>Addition<a class="headerlink" href="#addition" title="Permalink to this headline">¶</a></h2>
<span class="target" id="operator-add-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEplDaRR10_TensorLHSRR10_TensorRHS">
<span id="_CPPv3I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEplRR10_TensorLHSRR10_TensorRHS"></span><span id="_CPPv2I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEplRR10_TensorLHSRR10_TensorRHS"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">tmech</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_tensor_type</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEplDaRR10_TensorLHSRR10_TensorRHS" title="operator+::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">tmech</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_tensor_type</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEplDaRR10_TensorLHSRR10_TensorRHS" title="operator+::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__operators_8h_1a1f10c7a1cb7091cb6fa74638c0f883b3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">+</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEplDaRR10_TensorLHSRR10_TensorRHS" title="operator+::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_lhs</span></span>, <a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEplDaRR10_TensorLHSRR10_TensorRHS" title="operator+::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_rhs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEplDaRR10_TensorLHSRR10_TensorRHS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Addition of two tensors of same rank and dimension. </p>
<p><div class="math">
<p><img src="../_images/math/d530e4129e055c9101a5e6e561895bbfb589f9d6.svg" alt="C_{ijkl...} = A_{ijkl...} + B_{ijkl...}"/></p>
</div> <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">;</span>
<span class="n">a</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span> <span class="n">b</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_TensorLHS</strong> – Left hand side tensor object </p></li>
<li><p><strong>_TensorRHS</strong> – Right hand side tensor object </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor_lhs</strong> – Left hand side tensor expression. </p></li>
<li><p><strong>__tensor_rhs</strong> – Right hand side tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="subtraction">
<h2>Subtraction<a class="headerlink" href="#subtraction" title="Permalink to this headline">¶</a></h2>
<span class="target" id="operator-min-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmiDaRR10_TensorLHSRR10_TensorRHS">
<span id="_CPPv3I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmiRR10_TensorLHSRR10_TensorRHS"></span><span id="_CPPv2I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmiRR10_TensorLHSRR10_TensorRHS"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">tmech</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_tensor_type</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmiDaRR10_TensorLHSRR10_TensorRHS" title="operator-::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">tmech</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_tensor_type</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmiDaRR10_TensorLHSRR10_TensorRHS" title="operator-::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__operators_8h_1a0a3c02d25153c5383ca81ed57fbca5e2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">-</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmiDaRR10_TensorLHSRR10_TensorRHS" title="operator-::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_lhs</span></span>, <a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmiDaRR10_TensorLHSRR10_TensorRHS" title="operator-::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_rhs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmiDaRR10_TensorLHSRR10_TensorRHS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Subtraction of two tensors of same rank and dimension. </p>
<p><div class="math">
<p><img src="../_images/math/157ab4de27b6172f7dc4c72093eca9dc09e11047.svg" alt="C_{ijkl...} = A_{ijkl...} - B_{ijkl...}"/></p>
</div></p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">;</span>
<span class="n">a</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span> <span class="n">b</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">;</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_TensorLHS</strong> – Left hand side tensor object </p></li>
<li><p><strong>_TensorRHS</strong> – Right hand side tensor object </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor_lhs</strong> – Left hand side tensor expression. </p></li>
<li><p><strong>__tensor_rhs</strong> – Right hand side tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="single-contraction">
<h2>Single contraction<a class="headerlink" href="#single-contraction" title="Permalink to this headline">¶</a></h2>
<span class="target" id="operator-mul-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmlDaRR10_TensorLHSRR10_TensorRHS">
<span id="_CPPv3I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmlRR10_TensorLHSRR10_TensorRHS"></span><span id="_CPPv2I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmlRR10_TensorLHSRR10_TensorRHS"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">tmech</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_tensor_type</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmlDaRR10_TensorLHSRR10_TensorRHS" title="operator*::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">tmech</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_tensor_type</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmlDaRR10_TensorLHSRR10_TensorRHS" title="operator*::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__operators_8h_1a9d31b16c5975498b30f8aef4660dd658"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">*</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmlDaRR10_TensorLHSRR10_TensorRHS" title="operator*::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_lhs</span></span>, <a class="reference internal" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmlDaRR10_TensorLHSRR10_TensorRHS" title="operator*::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_rhs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorLHSE4typeEE5valueEEE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI10_TensorRHSE4typeEE5valueEEEEmlDaRR10_TensorLHSRR10_TensorRHS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Single contraction of two tensors. Assume that the left hand side tensor is of rank m and the right hand side tensor of rank n. The resulting tensor is of rank m+n-2. The most right index of the left hand side tensor is contracted with the most left index of the right hand tensor. </p>
<p><div class="math">
<p><img src="../_images/math/445de9538944f1b26c37c26e9091336063339ddd.svg" alt="C_{i_{1},...,i_{m+n-2}} = A_{i_{1},...,i_{m-1},k} - B_{k,i_{2},...,i_{n}}"/></p>
</div></p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">;</span>
<span class="n">a</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span> <span class="n">b</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_TensorLHS</strong> – Left hand side tensor object </p></li>
<li><p><strong>_TensorRHS</strong> – Right hand side tensor object </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor_lhs</strong> – Left hand side tensor expression. </p></li>
<li><p><strong>__tensor_rhs</strong> – Right hand side tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="scalar-update">
<h2>Scalar update<a class="headerlink" href="#scalar-update" title="Permalink to this headline">¶</a></h2>
<span class="target" id="operator-scalar-mul-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEmlDaRR7_ScalarRR7_Tensor">
<span id="_CPPv3I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEmlRR7_ScalarRR7_Tensor"></span><span id="_CPPv2I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEmlRR7_ScalarRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Scalar</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_fundamental</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEmlDaRR7_ScalarRR7_Tensor" title="operator*::_Scalar"><span class="n"><span class="pre">_Scalar</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">*</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">tmech</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_tensor_type</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEmlDaRR7_ScalarRR7_Tensor" title="operator*::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__operators_8h_1a7c732a7a1ff0b0a69618bd84a1973c75"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">*</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEmlDaRR7_ScalarRR7_Tensor" title="operator*::_Scalar"><span class="n"><span class="pre">_Scalar</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__scalar</span></span>, <a class="reference internal" href="#_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEmlDaRR7_ScalarRR7_Tensor" title="operator*::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEmlDaRR7_ScalarRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Scalar update of a tensor. </p>
<p><div class="math">
<p><img src="../_images/math/bc1e1efeb6f873b3a1950af6b3285fcdc616b728.svg" alt="C_{ijkl...} = a*C_{ijkl...}"/></p>
</div></p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
<span class="n">a</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_Tensor</strong> – Tensor object </p></li>
<li><p><strong>_Scalar</strong> – Scalar type. Must be a std::fundamental </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__scalar</strong> – Scalar </p></li>
<li><p><strong>__tensor</strong> – Tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="operator-scalar-dic-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEdvDaRR7_TensorRR7_Scalar">
<span id="_CPPv3I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEdvRR7_TensorRR7_Scalar"></span><span id="_CPPv2I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEdvRR7_TensorRR7_Scalar"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Scalar</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_fundamental</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEdvDaRR7_TensorRR7_Scalar" title="operator/::_Scalar"><span class="n"><span class="pre">_Scalar</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">*</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">tmech</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_tensor_type</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEdvDaRR7_TensorRR7_Scalar" title="operator/::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__operators_8h_1ad9041c7a7a35561a96fab7689b7aa648"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">/</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEdvDaRR7_TensorRR7_Scalar" title="operator/::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span>, <a class="reference internal" href="#_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEdvDaRR7_TensorRR7_Scalar" title="operator/::_Scalar"><span class="n"><span class="pre">_Scalar</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__scalar</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00_PNSt9enable_ifINSt14is_fundamentalINSt5decayI7_ScalarE4typeEE5valueEE4typeE_PNSt11enable_if_tIN5tmech14is_tensor_typeINSt5decayI7_TensorE4typeEE5valueEEEEdvDaRR7_TensorRR7_Scalar" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Tensor division by a scalar. </p>
<p><div class="math">
<p><img src="../_images/math/18821bacdf517049423e9fef711e4ade42db8c1d.svg" alt="C_{ijkl...} = C_{ijkl...}/a"/></p>
</div></p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
<span class="n">a</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="mf">2.0</span><span class="p">;</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_Tensor</strong> – Tensor object </p></li>
<li><p><strong>_Scalar</strong> – Scalar type. Must be a std::fundamental </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__scalar</strong> – Scalar </p></li>
<li><p><strong>__tensor</strong> – Tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="basis-rearrangement">
<h1>Basis rearrangement<a class="headerlink" href="#basis-rearrangement" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-basis-rearrangement">
<h2>General basis rearrangement<a class="headerlink" href="#general-basis-rearrangement" title="Permalink to this headline">¶</a></h2>
<span class="target" id="basis-change-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000E12basis_changeDaRR7_Tensor">
<span id="_CPPv3I0000E12basis_changeRR7_Tensor"></span><span id="_CPPv2I0000E12basis_changeRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Sequence</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a2ad8bde72f076a1ef9007cd53a10aff6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">basis_change</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0000E12basis_changeDaRR7_Tensor" title="basis_change::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000E12basis_changeDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>General basis rearrangement. Controlled by template parameter _Sequence, which contains the new order of bases. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//Basis 1,2,3,4 is swaped to 3,4,1,2.</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">basis_change</span><span class="o">&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">basis_change</span><span class="o">&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
 Self assignment <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//Basis 1,2,3,4 is swaped to 3,4,1,2.</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">eval</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">basis_change</span><span class="o">&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">A</span><span class="p">));</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">eval</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">basis_change</span><span class="o">&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">A</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">A</span><span class="p">));</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_Sequence</strong> – A tmech::sequence&lt;&gt;, which contains the new order of bases </p></li>
<li><p><strong>_Derived</strong> – Tensor object </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression from which the basis rearrangement is to be formed </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="transposition">
<h2>Transposition<a class="headerlink" href="#transposition" title="Permalink to this headline">¶</a></h2>
<span class="target" id="trans-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E5transDaRR7_Tensor">
<span id="_CPPv3I00E5transRR7_Tensor"></span><span id="_CPPv2I00E5transRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1af5623cbe1e471ab2a0046aa2a365e2d7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">trans</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E5transDaRR7_Tensor" title="trans::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E5transDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Wrapper function for transposition for a second-order tensor and major transposition of a fourth-order tensor. </p>
<p>The transpose of a second-order tensor in index notation <img class="math" src="../_images/math/0dda3c865893b16039587cfabf60aadfa9d3195f.svg" alt="(A_{ij})^T = A_{ji}"/>.\ The transpose of a fourth-order tensor in index notation <img class="math" src="../_images/math/f8630d589ecd5f36e40257262922c821336d0542.svg" alt="(A_{ijkl})^T = A_{klij}"/>. <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">trans</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
 <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">eval</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">trans</span><span class="p">(</span><span class="n">A</span><span class="p">));</span>
</pre></div>
</div>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression from which the transposition is to be formed. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="left-basis-transposition">
<h2>Left basis transposition<a class="headerlink" href="#left-basis-transposition" title="Permalink to this headline">¶</a></h2>
<span class="target" id="transl-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E6translDaRR7_Tensor">
<span id="_CPPv3I00E6translRR7_Tensor"></span><span id="_CPPv2I00E6translRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a56998be42df31a501861296f22e0c98d"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">transl</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E6translDaRR7_Tensor" title="transl::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E6translDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Transposition of the left base a fourth-order tensor <img class="math" src="../_images/math/eb458a8eb1592a2f6a7884ea1ab3107f82da0064.svg" alt="(A_{ijkl})^{l} = A_{jikl}"/>. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">transl</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
 <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">eval</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">transl</span><span class="p">(</span><span class="n">A</span><span class="p">));</span>
</pre></div>
</div>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression from which the left transpose part is to be formed. </p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="outer-product">
<h1>Outer product<a class="headerlink" href="#outer-product" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-outer-product">
<h2>General outer product<a class="headerlink" href="#general-outer-product" title="Permalink to this headline">¶</a></h2>
<span class="target" id="outer-product-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000000E13outer_productDaRR10_TensorLHSRR10_TensorRHS">
<span id="_CPPv3I000000E13outer_productRR10_TensorLHSRR10_TensorRHS"></span><span id="_CPPv2I000000E13outer_productRR10_TensorLHSRR10_TensorRHS"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_SequenceLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_SequenceRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a8e7308c59ddf9f963a80cc50363dc1b5"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">outer_product</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000000E13outer_productDaRR10_TensorLHSRR10_TensorRHS" title="outer_product::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_lhs</span></span>, <a class="reference internal" href="#_CPPv4I000000E13outer_productDaRR10_TensorLHSRR10_TensorRHS" title="outer_product::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_rhs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000000E13outer_productDaRR10_TensorLHSRR10_TensorRHS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>General outer product. Controlled by template parameters _SequenceLHS and _SequenceRHS. Bases contained in sequence _SequenceLHS are used for ordered element acces in __lhs tensor expression. Bases contained in sequence _SequenceRHS are used for ordered element acces in __rhs tensor expression. Both togther peform outer product. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">SeqL</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">SeqR</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">;</span>
<span class="c1">//Bases 1,2 of the new tensor C</span>
<span class="c1">//are given by a and bases 3,4 are</span>
<span class="c1">//given by b.</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">;</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">outer_product</span><span class="o">&lt;</span><span class="n">SeqL</span><span class="p">,</span> <span class="n">SeqR</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_SequenceLHS</strong> – Left hand side sequence, which contains numbers of bases to peform the outer product. </p></li>
<li><p><strong>_SequenceRHS</strong> – Right hand side sequence, which contains numbers of bases to peform the outer product. </p></li>
<li><p><strong>_TensorLHS</strong> – Left hand side tensor object </p></li>
<li><p><strong>_TensorRHS</strong> – Right hand side tensor object</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor_lhs</strong> – Left hand side tensor expression. </p></li>
<li><p><strong>__tensor_rhs</strong> – Reft hand side tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="dyadic-product">
<h2>Dyadic product<a class="headerlink" href="#dyadic-product" title="Permalink to this headline">¶</a></h2>
<span class="target" id="otimes-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000E6otimesDaRR10_TensorLHSRR10_TensorRHS">
<span id="_CPPv3I0000E6otimesRR10_TensorLHSRR10_TensorRHS"></span><span id="_CPPv2I0000E6otimesRR10_TensorLHSRR10_TensorRHS"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1ad18ae7c3053c78ed1e6f787ad6cca32f"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">otimes</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0000E6otimesDaRR10_TensorLHSRR10_TensorRHS" title="otimes::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_lhs</span></span>, <a class="reference internal" href="#_CPPv4I0000E6otimesDaRR10_TensorLHSRR10_TensorRHS" title="otimes::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_rhs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000E6otimesDaRR10_TensorLHSRR10_TensorRHS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The dyadic product between a tensor object of order n and a tensor object of order m is a tensor of order m + n. The dyadic product between two first-order tensors is defined as. </p>
<p><div class="math">
<p><img src="../_images/math/bd562bf070d4b959defbed5cf2d5a77f569e52b5.svg" alt="A_{i_{1},...,i_{n},i_{n+1},...,i_{m}} = a_{i_{i},...,i_{n}} b_{i_{n+1},...,i_{m}}"/></p>
</div></p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">C</span><span class="p">{</span><span class="n">tmech</span><span class="o">::</span><span class="n">times</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)};</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="o">&gt;</span> <span class="n">D</span><span class="p">{</span><span class="n">tmech</span><span class="o">::</span><span class="n">times</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">B</span><span class="p">)};</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="o">&gt;</span> <span class="n">E</span><span class="p">{</span><span class="n">tmech</span><span class="o">::</span><span class="n">times</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">)};</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_TensorLHS</strong> – Left hand side tensor object </p></li>
<li><p><strong>_TensorRHS</strong> – Right hand side tensor object</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor_lhs</strong> – Left hand side tensor expression. </p></li>
<li><p><strong>__tensor_rhs</strong> – Reft hand side tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="lower-dyadic-product">
<h2>Lower dyadic product<a class="headerlink" href="#lower-dyadic-product" title="Permalink to this headline">¶</a></h2>
<span class="target" id="otimesl-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000E7otimeslDaRR10_TensorLHSRR10_TensorRHS">
<span id="_CPPv3I0000E7otimeslRR10_TensorLHSRR10_TensorRHS"></span><span id="_CPPv2I0000E7otimeslRR10_TensorLHSRR10_TensorRHS"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a57ae5e76d46f8f69656271f3b320f34f"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">otimesl</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0000E7otimeslDaRR10_TensorLHSRR10_TensorRHS" title="otimesl::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_lhs</span></span>, <a class="reference internal" href="#_CPPv4I0000E7otimeslDaRR10_TensorLHSRR10_TensorRHS" title="otimesl::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_rhs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000E7otimeslDaRR10_TensorLHSRR10_TensorRHS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The <img class="math" src="../_images/math/ed2e455dd63828500ebb0ae67ceb9069f9885685.svg" alt="\underline{\otimes}"/> product between two second-order tensors is defined as. </p>
<p><div class="math">
<p><img src="../_images/math/40dbe0954a959773bc1eb5dac3303e03210fab49.svg" alt="\FourthT{C} = \SecondT{A} \underline{\otimes} \SecondT{B} = A_{ij} B_{kl} \SecondT{e}_i \otimes \SecondT{e}_l \otimes \SecondT{e}_j \otimes \SecondT{e}_k."/></p>
</div></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_TensorLHS</strong> – Left hand side tensor object </p></li>
<li><p><strong>_TensorRHS</strong> – Right hand side tensor object</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor_lhs</strong> – Left hand side tensor expression. </p></li>
<li><p><strong>__tensor_rhs</strong> – Reft hand side tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="upper-dyadic-product">
<h2>Upper dyadic product<a class="headerlink" href="#upper-dyadic-product" title="Permalink to this headline">¶</a></h2>
<span class="target" id="otimesu-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000E7otimesuDaRR10_TensorLHSRR10_TensorRHS">
<span id="_CPPv3I0000E7otimesuRR10_TensorLHSRR10_TensorRHS"></span><span id="_CPPv2I0000E7otimesuRR10_TensorLHSRR10_TensorRHS"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a73cdc8ec84a59a13a0f27ff975125a2f"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">otimesu</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0000E7otimesuDaRR10_TensorLHSRR10_TensorRHS" title="otimesu::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_lhs</span></span>, <a class="reference internal" href="#_CPPv4I0000E7otimesuDaRR10_TensorLHSRR10_TensorRHS" title="otimesu::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_rhs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000E7otimesuDaRR10_TensorLHSRR10_TensorRHS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The <img class="math" src="../_images/math/88ea41e2dd7c5386588f48edd18796b7c16b792a.svg" alt="\overline{\otimes}"/> product between two second-order tensors is defined as. </p>
<p><div class="math">
<p><img src="../_images/math/128f6960084408bad16b4bf52fb5e3d66faf6d19.svg" alt="\FourthT{C} = \SecondT{A} \overline{\otimes} \SecondT{B} = A_{ij} B_{kl} \SecondT{e}_i \otimes \SecondT{e}_k \otimes \SecondT{e}_j \otimes \SecondT{e}_l"/></p>
</div> and represents a transposition of the two inner bases.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_TensorLHS</strong> – Left hand side tensor object </p></li>
<li><p><strong>_TensorRHS</strong> – Right hand side tensor object</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor_lhs</strong> – Left hand side tensor expression. </p></li>
<li><p><strong>__tensor_rhs</strong> – Reft hand side tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="inner-product">
<h1>Inner product<a class="headerlink" href="#inner-product" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-inner-product">
<h2>General inner product<a class="headerlink" href="#general-inner-product" title="Permalink to this headline">¶</a></h2>
<span class="target" id="inner-product-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000000E13inner_productDaRR10_TensorLHSRR10_TensorRHS">
<span id="_CPPv3I000000E13inner_productRR10_TensorLHSRR10_TensorRHS"></span><span id="_CPPv2I000000E13inner_productRR10_TensorLHSRR10_TensorRHS"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_SequenceLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_SequenceRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1ab823f96592e7ff514d2cddcd1d93b6b2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inner_product</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000000E13inner_productDaRR10_TensorLHSRR10_TensorRHS" title="inner_product::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_lhs</span></span>, <a class="reference internal" href="#_CPPv4I000000E13inner_productDaRR10_TensorLHSRR10_TensorRHS" title="inner_product::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_rhs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000000E13inner_productDaRR10_TensorLHSRR10_TensorRHS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>General inner product. Controlled by template parameters _SequenceLHS and _SequenceRHS. Bases contained in sequence _SequenceLHS are used for ordered element acces in _DerivedLHS tensor expression. Bases contained in sequence _SequenceRHS are used for ordered element acces in _DerivedRHS tensor expression. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">SeqL</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">SeqR</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">;</span>
<span class="c1">//Double contraction of two 4th order tensors</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">;</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">inner_product</span><span class="o">&lt;</span><span class="n">SeqL</span><span class="p">,</span> <span class="n">SeqR</span><span class="o">&gt;</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">);</span>

<span class="c1">//Double contraction of a 4th and a 2th order tensor</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">inner_product</span><span class="o">&lt;</span><span class="n">SeqL</span><span class="p">,</span> <span class="n">SeqR</span><span class="o">&gt;</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">a</span><span class="p">);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_SequenceLHS</strong> – Left hand side sequence, which contains the numbers of bases used for contraction. </p></li>
<li><p><strong>_SequenceRHS</strong> – Right hand side sequence, which contains the numbers of bases used for contraction. </p></li>
<li><p><strong>_TensorLHS</strong> – Left hand side tensor object </p></li>
<li><p><strong>_TensorRHS</strong> – Right hand side tensor object</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor_lhs</strong> – Left hand side tensor expression. </p></li>
<li><p><strong>__tensor_rhs</strong> – Reft hand side tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="double-contraction">
<h2>Double contraction<a class="headerlink" href="#double-contraction" title="Permalink to this headline">¶</a></h2>
<span class="target" id="double-contraction-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000E9dcontractDaRR10_TensorLHSRR10_TensorRHS">
<span id="_CPPv3I0000E9dcontractRR10_TensorLHSRR10_TensorRHS"></span><span id="_CPPv2I0000E9dcontractRR10_TensorLHSRR10_TensorRHS"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1ae434efe4996e6e9face6cfb074e79ee2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dcontract</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0000E9dcontractDaRR10_TensorLHSRR10_TensorRHS" title="dcontract::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_lhs</span></span>, <a class="reference internal" href="#_CPPv4I0000E9dcontractDaRR10_TensorLHSRR10_TensorRHS" title="dcontract::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_rhs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000E9dcontractDaRR10_TensorLHSRR10_TensorRHS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A double contraction between two tensors objects contracts the two most right and left indices. The result of a double contraction between a tensor of order n and a tensor of order m is a tensor of order m + n - 4. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">;</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span> <span class="n">B</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">c</span><span class="p">{</span><span class="n">tmech</span><span class="o">::</span><span class="n">dcontract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)};</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_TensorLHS</strong> – Left hand side tensor object </p></li>
<li><p><strong>_TensorRHS</strong> – Right hand side tensor object</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor_lhs</strong> – Left hand side tensor expression. </p></li>
<li><p><strong>__tensor_rhs</strong> – Reft hand side tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="fourth-contraction">
<h2>Fourth contraction<a class="headerlink" href="#fourth-contraction" title="Permalink to this headline">¶</a></h2>
<span class="target" id="fourth-contraction-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000E10ddcontractDaRR10_TensorLHSRR10_TensorRHS">
<span id="_CPPv3I0000E10ddcontractRR10_TensorLHSRR10_TensorRHS"></span><span id="_CPPv2I0000E10ddcontractRR10_TensorLHSRR10_TensorRHS"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorLHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_TensorRHS</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a0d4d3b9ca912de9fd4a00984dc00202d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ddcontract</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0000E10ddcontractDaRR10_TensorLHSRR10_TensorRHS" title="ddcontract::_TensorLHS"><span class="n"><span class="pre">_TensorLHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_lhs</span></span>, <a class="reference internal" href="#_CPPv4I0000E10ddcontractDaRR10_TensorLHSRR10_TensorRHS" title="ddcontract::_TensorRHS"><span class="n"><span class="pre">_TensorRHS</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor_rhs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000E10ddcontractDaRR10_TensorLHSRR10_TensorRHS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A fourth contraction between two tensors objects contracts the fourth most right and left indices. The result of a double contraction between a tensor of order n and a tensor of order m is a tensor of order m + n - 8. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">;</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span> <span class="n">B</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">c</span><span class="p">{</span><span class="n">tmech</span><span class="o">::</span><span class="n">ddcontract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)};</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_TensorLHS</strong> – Left hand side tensor object </p></li>
<li><p><strong>_TensorRHS</strong> – Right hand side tensor object</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor_lhs</strong> – Left hand side tensor expression. </p></li>
<li><p><strong>__tensor_rhs</strong> – Reft hand side tensor expression. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="invers-of-a-tensor">
<h1>Invers of a tensor<a class="headerlink" href="#invers-of-a-tensor" title="Permalink to this headline">¶</a></h1>
<div class="section" id="second-order-tensors-and-fourth-order-tensors-with-minior-symmetry">
<h2>Second order tensors and fourth order tensors with minior-symmetry<a class="headerlink" href="#second-order-tensors-and-fourth-order-tensors-with-minior-symmetry" title="Permalink to this headline">¶</a></h2>
<span class="target" id="inv-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDp00E3invDaRR7_Tensor">
<span id="_CPPv3IDp00E3invRR7_Tensor"></span><span id="_CPPv2IDp00E3invRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">_Sequences</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a8ece8e536c42db89d01759cb42a2c00d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inv</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDp00E3invDaRR7_Tensor" title="inv::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDp00E3invDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Inverse of a second- and a fourth-order tensor. The inverse of a second order tensor is defined by <img class="math" src="../_images/math/1784d834559212a0e306329953c634ab371abba6.svg" alt="\SecondT{A}^{-1}\SecondT{A} = \SecondT{I}"/>, where <img class="math" src="../_images/math/4884ba23ca9f2e0e39768916d492c21a61eca633.svg" alt="\SecondT{I}"/> is the second order identity tensor. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<p>The inverse of a fourth order tensor depends on the minior-symmetry. Using the following differentiation rule <img class="math" src="../_images/math/6b5eced7e80deb9361c43dd7c159b045be9c0fa2.svg" alt="\FourthT{C}_{ijkl} = \frac{\partial \SecondT{a}_{ij} }{\partial \SecondT{b}_{kl}}"/> yields a minior-symmetry in the first and in the second pair of indicies <img class="math" src="../_images/math/34411df04ee6d8090f11a2d28bb37d898cb27052.svg" alt="i,j"/> and <img class="math" src="../_images/math/d9b0c024bc90c72320e28cea425a5853e586bab2.svg" alt="k,l"/>, respectively. In this case the inverse is defined by <img class="math" src="../_images/math/7b0579f655d5c320cb4d7cd11bc51451ac50871f.svg" alt="(\FourthT{A}^{-1})_{ijmn}\FourthT{A}_{mnkl} =\frac{1}{2}\left(\SecondT{I}_{ik}\SecondT{I}_{jl} + \SecondT{I}_{il}\SecondT{I}_{jk} \right)"/>. <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="c1">//the sequences are indicating the pairs of minior-symmetry</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">inv</span><span class="o">&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="c1">// the rule above is the most used one, therefore the following is sufficient.</span>
<span class="c1">// the correct indicies are set inside the function.</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<p>Using the following differentiation rule <img class="math" src="../_images/math/1e89401807e9facf6ba7086beeb69ae0f2f823bc.svg" alt="\FourthT{C}_{iklj} = \frac{\partial \SecondT{a}_{ij} }{\partial \SecondT{b}_{kl}}"/>, yields a minior symmetry in the outer and in the inner pair of indicies <img class="math" src="../_images/math/a00a70b85bfed77c9362d548799170150f94054f.svg" alt="i,j"/> and <img class="math" src="../_images/math/d9b0c024bc90c72320e28cea425a5853e586bab2.svg" alt="k,l"/>, respectively. <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="c1">//the sequences are indicating the pairs of minior-symmetry</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">inv</span><span class="o">&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression from which the inverse is to be formed. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="fully-anisotropic-tensors">
<h2>Fully anisotropic tensors<a class="headerlink" href="#fully-anisotropic-tensors" title="Permalink to this headline">¶</a></h2>
<span class="target" id="invf-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDp00E4invfDaRR7_Tensor">
<span id="_CPPv3IDp00E4invfRR7_Tensor"></span><span id="_CPPv2IDp00E4invfRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">_Sequences</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a7d6748b84344f1268af2ed33e93ba212"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">invf</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDp00E4invfDaRR7_Tensor" title="invf::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDp00E4invfDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Inverse of a second- and a full anisotropic fourth-order tensor. The inverse of a second order tensor is defined by <img class="math" src="../_images/math/1784d834559212a0e306329953c634ab371abba6.svg" alt="\SecondT{A}^{-1}\SecondT{A} = \SecondT{I}"/>, where <img class="math" src="../_images/math/4884ba23ca9f2e0e39768916d492c21a61eca633.svg" alt="\SecondT{I}"/> is the second order identity tensor. In the case of a second oder tensor the ouput is the same as from the function inv. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">invf</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="c1">//or</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<p>This function assumes, that a fourth order tensor has no minior-symmetry and is therefore fully anisotropic. In this case the inverse is defined by <img class="math" src="../_images/math/fb47f1f0fd01469071e060e8c1b14b37213684e0.svg" alt="(\FourthT{A}^{-1})_{ijmn}\FourthT{A}_{mnkl} =\SecondT{I}_{ij}\SecondT{I}_{kl}"/>. <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">invf</span><span class="o">&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="c1">// the rule above is the most used one, therefore the following is sufficient.</span>
<span class="c1">// the correct indicies are set inside the function.</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">invf</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<p>Using other kind of differentiation rules as <img class="math" src="../_images/math/6b5eced7e80deb9361c43dd7c159b045be9c0fa2.svg" alt="\FourthT{C}_{ijkl} = \frac{\partial \SecondT{a}_{ij} }{\partial \SecondT{b}_{kl}}"/> must be indicated, due to the internal storage scheme. For example using <img class="math" src="../_images/math/1e89401807e9facf6ba7086beeb69ae0f2f823bc.svg" alt="\FourthT{C}_{iklj} = \frac{\partial \SecondT{a}_{ij} }{\partial \SecondT{b}_{kl}}"/>. <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">invf</span><span class="o">&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression from which the inverse is to be formed. </p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="volumetric-and-deviatoric-parts">
<h1>Volumetric and deviatoric parts<a class="headerlink" href="#volumetric-and-deviatoric-parts" title="Permalink to this headline">¶</a></h1>
<div class="section" id="volumetric-part">
<h2>Volumetric part<a class="headerlink" href="#volumetric-part" title="Permalink to this headline">¶</a></h2>
<span class="target" id="vol-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E3volDaRR7_Tensor">
<span id="_CPPv3I00E3volRR7_Tensor"></span><span id="_CPPv2I00E3volRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1af8fe28951bd0cfd709d76597cee698a3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vol</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E3volDaRR7_Tensor" title="vol::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E3volDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Volumetric part of a second-order tensor <img class="math" src="../_images/math/2fb6950a221c267c801daf9d1210f67f92e72136.svg" alt="\text{vol}(\SecondT{A}) = \frac{1}{d}\text{trace}(\SecondT{A})\SecondT{I}"/>, where <img class="math" src="../_images/math/2d29f7484bbeeac67d6982cd848e24773f78af70.svg" alt="d"/> is the dimension. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">vol</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression from which the volumetric part is to be formed. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="deviatoric-part">
<h2>Deviatoric part<a class="headerlink" href="#deviatoric-part" title="Permalink to this headline">¶</a></h2>
<span class="target" id="dev-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E3devDaRR7_Tensor">
<span id="_CPPv3I00E3devRR7_Tensor"></span><span id="_CPPv2I00E3devRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a025e2ea43aa2979ddacda5f8ecd194ab"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dev</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E3devDaRR7_Tensor" title="dev::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E3devDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Deviatoric part of a second-order tensor <img class="math" src="../_images/math/ea0b1bc04f3c0b3ec257901f9676709147a6f080.svg" alt="\SecondT{A} = \text{vol}(\SecondT{A}) + \text{dev}(\SecondT{A})"/>. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">dev</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression from which the deviatoric part is to be formed. </p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="symmetric-and-skew-symmetric-parts">
<h1>Symmetric and skew-symmetric parts<a class="headerlink" href="#symmetric-and-skew-symmetric-parts" title="Permalink to this headline">¶</a></h1>
<div class="section" id="symmetric-part">
<h2>Symmetric part<a class="headerlink" href="#symmetric-part" title="Permalink to this headline">¶</a></h2>
<span class="target" id="sym-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E3symDaRR7_Tensor">
<span id="_CPPv3I00E3symRR7_Tensor"></span><span id="_CPPv2I00E3symRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1aec7d5ef1e4b4345ea59f33ff5a18b262"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sym</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E3symDaRR7_Tensor" title="sym::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E3symDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Symmetric part of a second-order tensor <img class="math" src="../_images/math/a62d09af51b98772aee92786bc40161d7c90e00a.svg" alt="\text{sym}\left(\SecondT{A}\right) = \frac{1}{2}\left(\SecondT{A} + \SecondT{A}^T \right)"/>. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sym</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression from which the symmetric part is to be formed. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="skew-symmetric-part">
<h2>Skew-symmetric part<a class="headerlink" href="#skew-symmetric-part" title="Permalink to this headline">¶</a></h2>
<span class="target" id="skew-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E4skewDaRR7_Tensor">
<span id="_CPPv3I00E4skewRR7_Tensor"></span><span id="_CPPv2I00E4skewRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1adf87627ca1798413070a578e9f5abbdc"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">skew</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E4skewDaRR7_Tensor" title="skew::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E4skewDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Skew-symmetric part of a second-order tensor <img class="math" src="../_images/math/77fb7898e096b029f50accbb2ec53ca677b11cb0.svg" alt="\text{skew}\left(\SecondT{A}\right) = \frac{1}{2}\left(\SecondT{A} - \SecondT{A}^T \right)"/>. </p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">skew</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression from which the skew-symmetric part is to be formed. </p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="isotropic-tensor-functions">
<h1>Isotropic tensor functions<a class="headerlink" href="#isotropic-tensor-functions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-function">
<h2>General function<a class="headerlink" href="#general-function" title="Permalink to this headline">¶</a></h2>
<span class="target" id="general-iso-func-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000E25isotropic_tensor_functionDaRR7_Tensor">
<span id="_CPPv3I000E25isotropic_tensor_functionRR7_Tensor"></span><span id="_CPPv2I000E25isotropic_tensor_functionRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Function</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a191f1bb62340aa3271dd179095d204b9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isotropic_tensor_function</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000E25isotropic_tensor_functionDaRR7_Tensor" title="isotropic_tensor_function::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000E25isotropic_tensor_functionDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Isotropic tensor function of a symmetric second-order tensor. </p>
<p><img class="math" src="../_images/math/78dbaeef41e511ed87b73e0caa980f65c54cea6a.svg" alt="\SecondT{Y} = \sum_{i=1}^m y_i \SecondT{E}_i"/></p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">sqrt</span><span class="p">{</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span>  <span class="n">T</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="k">constexpr</span> <span class="kr">inline</span> <span class="k">auto</span> <span class="n">apply</span><span class="p">(</span><span class="n">T</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">){</span><span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="n">value</span><span class="p">);}</span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span>  <span class="n">T</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="k">constexpr</span> <span class="kr">inline</span> <span class="k">auto</span> <span class="n">derivative</span><span class="p">(</span><span class="n">T</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">){</span><span class="k">return</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="n">value</span><span class="p">));}</span>
<span class="p">};</span>

<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">isotropic_tensor_function</span><span class="o">&lt;</span><span class="n">sqrt</span><span class="o">&gt;</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_Function</strong> – </p></li>
<li><p><strong>_Tensor</strong> – Tensor object </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="square-root">
<h2>Square root<a class="headerlink" href="#square-root" title="Permalink to this headline">¶</a></h2>
<span class="target" id="sqrt-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E4sqrtDaRR7_Tensor">
<span id="_CPPv3I00E4sqrtRR7_Tensor"></span><span id="_CPPv2I00E4sqrtRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1aebfc6d1f45ac7ec41577100f2331bee3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sqrt</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E4sqrtDaRR7_Tensor" title="sqrt::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E4sqrtDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Square root of a positive semi-definite symmetric second-order tensor <img class="math" src="../_images/math/1dd10633e54e3e1d4244a977d5786dc70ec02275.svg" alt="\text{sqrt}(\SecondT{A}) = \sqrt{\SecondT{A}}"/>. The square is given by spectral decomposition. </p>
<p><div class="math">
<p><img src="../_images/math/9303a17b74f5dcb6e8e68cd5142d3badc1498c3a.svg" alt="\sqrt{\SecondT{A}} = \sum_{i}^m \sqrt{\lambda_i} \SecondT{E}_i,"/></p>
</div> where <img class="math" src="../_images/math/70205981123dde90873c20a964bf7545fce84e4b.svg" alt="m"/> is the number of non repeated eigenvalues <img class="math" src="../_images/math/6616fa8d47cbc5c2a9c85a6f64997687fb02fef4.svg" alt="\lambda_i"/> and <img class="math" src="../_images/math/29860908ac2d47bcc4cd2474f72d2244c8b25d2f.svg" alt="\SecondT{E}_i"/> is the corresponding eigenbase.</p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sym</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">randn</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">());</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="exponential-map">
<h2>Exponential map<a class="headerlink" href="#exponential-map" title="Permalink to this headline">¶</a></h2>
<span class="target" id="exp-sym-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E7exp_symDaRR7_Tensor">
<span id="_CPPv3I00E7exp_symRR7_Tensor"></span><span id="_CPPv2I00E7exp_symRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1ac2ea32877f43b2fdae9644ec7556e7fe"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">exp_sym</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E7exp_symDaRR7_Tensor" title="exp_sym::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E7exp_symDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Exponential map <img class="math" src="../_images/math/49988a273fec704a72e35024a4fbca9fd4139bef.svg" alt="\text{exp}(\SecondT{A})"/> of a positive semi-definite symmetric second-order tensor. The exponential map is given by spectral decomposition. </p>
<p><div class="math">
<p><img src="../_images/math/a1c42d5f8b97de1a7d468c0e3eab45a774e2139f.svg" alt="\sqrt{\SecondT{A}} = \sum_{i}^m \exp{\lambda_i} \SecondT{E}_i,"/></p>
</div> where <img class="math" src="../_images/math/70205981123dde90873c20a964bf7545fce84e4b.svg" alt="m"/> is the number of non repeated eigenvalues <img class="math" src="../_images/math/6616fa8d47cbc5c2a9c85a6f64997687fb02fef4.svg" alt="\lambda_i"/> and <img class="math" src="../_images/math/29860908ac2d47bcc4cd2474f72d2244c8b25d2f.svg" alt="\SecondT{E}_i"/> is the corresponding eigenbase.</p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sym</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">randn</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">());</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">exp_sym</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="logarithmic-map">
<h2>Logarithmic map<a class="headerlink" href="#logarithmic-map" title="Permalink to this headline">¶</a></h2>
<span class="target" id="log-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E3logDaRR7_Tensor">
<span id="_CPPv3I00E3logRR7_Tensor"></span><span id="_CPPv2I00E3logRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a1f1a00e2869f82fd19bd4f8ee83aed05"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">log</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E3logDaRR7_Tensor" title="log::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E3logDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Logarithmic map <img class="math" src="../_images/math/f4e970c0572c792d81362b671e230733de3356ed.svg" alt="\text{log}(\SecondT{A})"/> of a positive semi-definite symmetric second-order tensor. The Logarithmic map is given by spectral decomposition. </p>
<p><div class="math">
<p><img src="../_images/math/6efe7b992ae7456bda240f3f79e296ee4f3c53d5.svg" alt="\sqrt{\SecondT{A}} = \sum_{i}^m \log{\lambda_i} \SecondT{E}_i,"/></p>
</div> where <img class="math" src="../_images/math/70205981123dde90873c20a964bf7545fce84e4b.svg" alt="m"/> is the number of non repeated eigenvalues <img class="math" src="../_images/math/6616fa8d47cbc5c2a9c85a6f64997687fb02fef4.svg" alt="\lambda_i"/> and <img class="math" src="../_images/math/29860908ac2d47bcc4cd2474f72d2244c8b25d2f.svg" alt="\SecondT{E}_i"/> is the corresponding eigenbase.</p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sym</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">randn</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">());</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression </p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="positive-negative-decomposition">
<h1>Positive-negative decomposition<a class="headerlink" href="#positive-negative-decomposition" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-method">
<h2>General method<a class="headerlink" href="#general-method" title="Permalink to this headline">¶</a></h2>
<span class="target" id="positive-negative-decomposition-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E31positive_negative_decompositionDaRR7_Tensor">
<span id="_CPPv3I00E31positive_negative_decompositionRR7_Tensor"></span><span id="_CPPv2I00E31positive_negative_decompositionRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a8a8699abd343b001dbdbc7b1b1f8d3ff"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">positive_negative_decomposition</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E31positive_negative_decompositionDaRR7_Tensor" title="positive_negative_decomposition::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E31positive_negative_decompositionDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Positive and negative decomposition part <img class="math" src="../_images/math/7e285a63c92684346385ed6fdf1a1219d40791c9.svg" alt="\SecondT{A} = \SecondT{A}^{+} + \SecondT{A}^{-}"/> of a positive semi-definite symmetric second-order tensor is given by spectral decomposition. </p>
<p><div class="math">
<p><img src="../_images/math/1f00b37e22138118057cc47ec5b52d0993540928.svg" alt="\SecondT{A}^{+} = \sum_{i}^m \text{pos}(\lambda_i) \SecondT{E}_i,\quad \text{with} \quad \text{pos}(\lambda_i)= \begin{cases} \lambda_i ~\text{if}~ \lambda_i &gt; 0\\ 0 ~\text{if}~ \lambda_i &lt; 0 \end{cases}\\ {\SecondT{A}}^{-} = \sum_{i}^m \text{neg}(\lambda_i) \SecondT{E}_i,\quad \text{with} \quad \text{neg}(\lambda_i)= \begin{cases} \lambda_i ~\text{if}~ \lambda_i &lt; 0\\ 0 ~\text{if}~ \lambda_i &gt; 0 \end{cases}"/></p>
</div> where <img class="math" src="../_images/math/70205981123dde90873c20a964bf7545fce84e4b.svg" alt="m"/> is the number of non repeated eigenvalues <img class="math" src="../_images/math/6616fa8d47cbc5c2a9c85a6f64997687fb02fef4.svg" alt="\lambda_i"/> and <img class="math" src="../_images/math/29860908ac2d47bcc4cd2474f72d2244c8b25d2f.svg" alt="\SecondT{E}_i"/> is the corresponding eigenbase.</p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sym</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">randn</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">());</span>
<span class="k">auto</span> <span class="n">A_pos_neg</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">positive_negative_decomposition</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">A_pos</span> <span class="o">=</span> <span class="n">A_pos_neg</span><span class="p">.</span><span class="n">positive</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">A_neg</span> <span class="o">=</span> <span class="n">A_pos_neg</span><span class="p">.</span><span class="n">negative</span><span class="p">();</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="only-positive-part">
<h2>Only positive part<a class="headerlink" href="#only-positive-part" title="Permalink to this headline">¶</a></h2>
<span class="target" id="positive-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E8positiveDaRR7_Tensor">
<span id="_CPPv3I00E8positiveRR7_Tensor"></span><span id="_CPPv2I00E8positiveRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a93c167f3bc3ce432a768dae75b8c6fcc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">positive</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E8positiveDaRR7_Tensor" title="positive::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E8positiveDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The positive part <img class="math" src="../_images/math/e283cc6a0d5f6fbb8078176144232b56f25f7732.svg" alt="\SecondT{A}^{+} = \SecondT{A} - \SecondT{A}^{-}"/> of a positive semi-definite symmetric second-order tensor is given by spectral decomposition. </p>
<p><div class="math">
<p><img src="../_images/math/cbcc354df2941d9941943b8d5920e4f59ea5ab0a.svg" alt="\SecondT{A}^{+} = \sum_{i}^m \text{pos}(\lambda_i) \SecondT{E}_i,\quad \text{with} \quad \text{pos}(\lambda_i)= \begin{cases} \lambda_i ~\text{if}~ \lambda_i &gt; 0\\ 0 ~\text{if}~ \lambda_i &lt; 0 \end{cases}"/></p>
</div> where <img class="math" src="../_images/math/70205981123dde90873c20a964bf7545fce84e4b.svg" alt="m"/> is the number of non repeated eigenvalues <img class="math" src="../_images/math/6616fa8d47cbc5c2a9c85a6f64997687fb02fef4.svg" alt="\lambda_i"/> and <img class="math" src="../_images/math/29860908ac2d47bcc4cd2474f72d2244c8b25d2f.svg" alt="\SecondT{E}_i"/> is the corresponding eigenbase. <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sym</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">randn</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">());</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">positive</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
 If both parts <img class="math" src="../_images/math/1b811049e605db35eeca825e32df17c8b19eced0.svg" alt="\SecondT{A}^{+}"/> and <img class="math" src="../_images/math/73f5d3ba1c3d36353716cb7649f9290b902293f3.svg" alt="\SecondT{A}^{-}"/> are needed use <code class="docutils literal notranslate"><span class="pre">positive_negative_decomposition()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="only-negative-part">
<h2>Only negative part<a class="headerlink" href="#only-negative-part" title="Permalink to this headline">¶</a></h2>
<span class="target" id="negative-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E8negativeDaRR7_Tensor">
<span id="_CPPv3I00E8negativeRR7_Tensor"></span><span id="_CPPv2I00E8negativeRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a3f2b02f435abddd8c6d6f7ea44f398e8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">negative</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E8negativeDaRR7_Tensor" title="negative::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E8negativeDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The negative part <img class="math" src="../_images/math/7ed1db9976d2957a1602e017cc5c99d061e3d70d.svg" alt="\SecondT{A}^{-} = \SecondT{A} - \SecondT{A}^{+}"/> of a positive semi-definite symmetric second-order tensor is given by spectral decomposition. </p>
<p><div class="math">
<p><img src="../_images/math/21f6dd50817acaa05302d549e177aa5e0cca99a8.svg" alt="{\SecondT{A}}^{-} = \sum_{i}^m \text{neg}(\lambda_i) \SecondT{E}_i,\quad \text{with} \quad \text{neg}(\lambda_i)= \begin{cases} \lambda_i ~\text{if}~ \lambda_i &lt; 0\\ 0 ~\text{if}~ \lambda_i &gt; 0 \end{cases}"/></p>
</div> where <img class="math" src="../_images/math/70205981123dde90873c20a964bf7545fce84e4b.svg" alt="m"/> is the number of non repeated eigenvalues <img class="math" src="../_images/math/6616fa8d47cbc5c2a9c85a6f64997687fb02fef4.svg" alt="\lambda_i"/> and <img class="math" src="../_images/math/29860908ac2d47bcc4cd2474f72d2244c8b25d2f.svg" alt="\SecondT{E}_i"/> is the corresponding eigenbase. <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sym</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">randn</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">());</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">negative</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
 If both parts <img class="math" src="../_images/math/1b811049e605db35eeca825e32df17c8b19eced0.svg" alt="\SecondT{A}^{+}"/> and <img class="math" src="../_images/math/73f5d3ba1c3d36353716cb7649f9290b902293f3.svg" alt="\SecondT{A}^{-}"/> are needed use <code class="docutils literal notranslate"><span class="pre">positive_negative_decomposition()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression </p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="eigen-decomposition">
<h1>Eigen-decomposition<a class="headerlink" href="#eigen-decomposition" title="Permalink to this headline">¶</a></h1>
<span class="target" id="eigen-decompositoin-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E19eigen_decompositionDaRR7_Tensor">
<span id="_CPPv3I00E19eigen_decompositionRR7_Tensor"></span><span id="_CPPv2I00E19eigen_decompositionRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1a8938a2238e483658e39dc4a320d2914b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">eigen_decomposition</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E19eigen_decompositionDaRR7_Tensor" title="eigen_decomposition::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E19eigen_decompositionDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Eigendecomposition of a positive semi-definite symmetric second-order tensor. </p>
<p><div class="math">
<p><img src="../_images/math/cae55fb2fbfbfdf9f6b39d53c387c2a3d381c078.svg" alt="\SecondT{Y} = \sum_{i=1}^m \lambda_i \FirstT{e}_i \otimes \FirstT{e}_i = \sum_{i=1}^m \lambda_i \SecondT{E}_i,"/></p>
</div> where <img class="math" src="../_images/math/70205981123dde90873c20a964bf7545fce84e4b.svg" alt="m"/> is the number of non repeated eigenvalues, <img class="math" src="../_images/math/6616fa8d47cbc5c2a9c85a6f64997687fb02fef4.svg" alt="\lambda_i"/> are the corresponding eigenvalues, <img class="math" src="../_images/math/5c14db6a400db6f1815632f2fac857fc6276b407.svg" alt="\FirstT{e}_i"/> eigenvectors and <img class="math" src="../_images/math/29860908ac2d47bcc4cd2474f72d2244c8b25d2f.svg" alt="\SecondT{E}_i"/> eigenbasen.</p>
<p>Using eigenbases to get the inverse <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">A_inv</span><span class="p">;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sym</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">randn</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">());</span>
<span class="k">auto</span> <span class="n">A_eig</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">eigen_decomposition</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="k">const</span> <span class="k">auto</span><span class="p">[</span><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenbasis</span><span class="p">]{</span><span class="n">A_eig</span><span class="p">.</span><span class="n">decompose_eigenbasis</span><span class="p">()};</span>
<span class="k">const</span> <span class="k">auto</span> <span class="n">idx</span><span class="p">{</span><span class="n">A_eig</span><span class="p">.</span><span class="n">non_repeated_eigenvalues_index</span><span class="p">()};</span>
<span class="k">for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">i</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">A_eig</span><span class="p">.</span><span class="n">number_non_repeated_eigenvalues</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="n">A_inv</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">eigenvalues</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">*</span><span class="n">eigenbasis</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
<span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span><span class="o">&lt;&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">almost_equal</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">A_inv</span><span class="p">,</span> <span class="mf">5e-7</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</p>
<p>Using eigenvectors to get the inverse <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">A_inv</span><span class="p">;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sym</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">randn</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">());</span>
<span class="k">auto</span> <span class="n">A_eig</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">eigen_decomposition</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="k">const</span> <span class="k">auto</span><span class="p">[</span><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span><span class="p">]{</span><span class="n">A_eig</span><span class="p">.</span><span class="n">decompose</span><span class="p">()};</span>
<span class="k">const</span> <span class="k">auto</span> <span class="n">idx</span><span class="p">{</span><span class="n">A_eig</span><span class="p">.</span><span class="n">non_repeated_eigenvalues_index</span><span class="p">()};</span>
<span class="k">for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span> <span class="n">i</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">A_eig</span><span class="p">.</span><span class="n">number_non_repeated_eigenvalues</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="n">A_inv</span> <span class="o">+=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">eigenvalues</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">*</span><span class="n">tmech</span><span class="o">::</span><span class="n">otimes</span><span class="p">(</span><span class="n">eigenvectors</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span><span class="n">eigenvectors</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]]);</span>
<span class="p">}</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span><span class="o">&lt;&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">almost_equal</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">A_inv</span><span class="p">,</span> <span class="mf">5e-7</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>__tensor</strong> – Tensor expression, from which the eigen decomposition is to be computed. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="sign-decomposition">
<h1>Sign decomposition<a class="headerlink" href="#sign-decomposition" title="Permalink to this headline">¶</a></h1>
<span class="target" id="sign-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E4signDaRR7_TensorNSt5decayI7_TensorE4type10value_typeENSt6size_tE">
<span id="_CPPv3I00E4signRR7_TensorNSt5decayI7_TensorE4type10value_typeENSt6size_tE"></span><span id="_CPPv2I00E4signRR7_TensorNSt5decayI7_TensorE4type10value_typeENSt6size_tE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1ab6e205e41fca79542988715b1e881421"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sign</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E4signDaRR7_TensorNSt5decayI7_TensorE4type10value_typeENSt6size_tE" title="sign::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span>, <span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E4signDaRR7_TensorNSt5decayI7_TensorE4type10value_typeENSt6size_tE" title="sign::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">__eps</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">5e-7</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">__max_iter</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">10</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E4signDaRR7_TensorNSt5decayI7_TensorE4type10value_typeENSt6size_tE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Sign tensor decomposition of a second-order tensor. </p>
<p><div class="math">
<p><img src="../_images/math/659f893034b0a6d8c812d50442cdd37e9efd77ea.svg" alt="\SecondT{A} = \SecondT{S}\SecondT{N}, \quad \SecondT{S} = \text{sign}(\SecondT{A}), \quad \SecondT{N} = \sqrt{\SecondT{A}\SecondT{A}}"/></p>
</div> The decomposition is based on a Newton iteration as describet <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/002437959490393X">here</a>. <div class="math">
<p><img src="../_images/math/9cef8bdfea88887649211fc08752b52a5f57cdc4.svg" alt="\SecondT{X}_{k+1} =\frac{1}{2}\left(\SecondT{X}_{k} + \SecondT{X}_{k}^{-1}\right), \quad \text{with} \quad \SecondT{X}_{0} = \SecondT{A}"/></p>
</div> which converges quadratically to <img class="math" src="../_images/math/f1d0dfac6f0928793fe1126de98b045ab851cd56.svg" alt="\text{sign}(\SecondT{A})"/> for any <img class="math" src="../_images/math/b835fded5cf054e632e4d7d5206b157cf07ae7be.svg" alt="\SecondT{A}"/> having no pure imaginary eigenvalues. <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">;</span>
<span class="n">A</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">sign</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor</strong> – Tensor expression from which the inverse is to be formed. </p></li>
<li><p><strong>__eps</strong> – Tolerance for Newton iteration </p></li>
<li><p><strong>__max_iter</strong> – Maximum of Newton iterations </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="polar-decomposition">
<h1>Polar decomposition<a class="headerlink" href="#polar-decomposition" title="Permalink to this headline">¶</a></h1>
<span class="target" id="polar-decomposition-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E19polar_decompositionDaRR7_TensorKbKNSt5decayI7_TensorE4type10value_typeEKNSt6size_tE">
<span id="_CPPv3I00E19polar_decompositionRR7_TensorKbKNSt5decayI7_TensorE4type10value_typeEKNSt6size_tE"></span><span id="_CPPv2I00E19polar_decompositionRR7_TensorKbKNSt5decayI7_TensorE4type10value_typeEKNSt6size_tE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1ae7d7cfd387ac1c434476b2298e23f289"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">polar_decomposition</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E19polar_decompositionDaRR7_TensorKbKNSt5decayI7_TensorE4type10value_typeEKNSt6size_tE" title="polar_decomposition::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">__newton_method</span></span>, <span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E19polar_decompositionDaRR7_TensorKbKNSt5decayI7_TensorE4type10value_typeEKNSt6size_tE" title="polar_decomposition::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">__tol</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">__max_steps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E19polar_decompositionDaRR7_TensorKbKNSt5decayI7_TensorE4type10value_typeEKNSt6size_tE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Polar decomposition of a positive semi-definite symmetric second-order tensor. </p>
<p><div class="math">
<p><img src="../_images/math/04adb2535a281439a2e2d6f9b0f3f2b758a6eaba.svg" alt="\SecondT{F}=\SecondT{R}\SecondT{U} = \SecondT{V}\SecondT{R}"/></p>
</div> where <img class="math" src="../_images/math/f307cd90ef966657c89a6feb0f04f8faf143a5ce.svg" alt="\SecondT{R}"/> is an orthogonal tensor also knwon as the rotation tensor, <img class="math" src="../_images/math/434e0605b394b4bc00e72c15b07849dfb6de19b1.svg" alt="\SecondT{U}"/> and <img class="math" src="../_images/math/e61f7ed918943b12f946485ef9024bdb2ed64d49.svg" alt="\SecondT{V}"/> are symmetric tensors called the right and the left stretch tensor, respectively. This function provides two different method to determine <img class="math" src="../_images/math/434e0605b394b4bc00e72c15b07849dfb6de19b1.svg" alt="\SecondT{U}"/>, <img class="math" src="../_images/math/e61f7ed918943b12f946485ef9024bdb2ed64d49.svg" alt="\SecondT{V}"/> and <img class="math" src="../_images/math/f307cd90ef966657c89a6feb0f04f8faf143a5ce.svg" alt="\SecondT{R}"/>. The frist method uses spectral decomposition <div class="math">
<p><img src="../_images/math/151de8d1f321df80ee5996fe81f5d767e2c0c4eb.svg" alt="\SecondT{U} = \sqrt{\SecondT{F}^T\SecondT{F}}, \quad \SecondT{R} = \SecondT{F}\SecondT{U}^{-1}, \quad \SecondT{V} = \SecondT{R}\SecondT{U}\SecondT{R}^T,"/></p>
</div> <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//use the spectral decomposition</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">F</span><span class="p">;</span>
<span class="n">F</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">F_polar</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">polar_decomposition</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F_polar</span><span class="p">.</span><span class="n">R</span><span class="p">()</span><span class="o">*</span><span class="n">F_polar</span><span class="p">.</span><span class="n">U</span><span class="p">();</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F_polar</span><span class="p">.</span><span class="n">V</span><span class="p">()</span><span class="o">*</span><span class="n">F_polar</span><span class="p">.</span><span class="n">R</span><span class="p">();</span>
</pre></div>
</div>
</p>
<p>The second one is based on a <a class="reference external" href="https://en.wikipedia.org/wiki/Polar_decomposition">Newton iteration</a> <div class="math">
<p><img src="../_images/math/e31a871fabd36dcb355169ae59cd8e1803d48e2d.svg" alt="\SecondT{R}_{k+1} =\frac{1}{2} \left( \SecondT{R}_k + \SecondT{R}_k^{-T}\right), \quad \text{with}\quad \SecondT{R}_0 = \SecondT{F}"/></p>
</div></p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//use the newton iteration</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">F</span><span class="p">;</span>
<span class="n">F</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">F_polar</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">polar_decomposition</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="c1">// tensor to decompose</span>
                                          <span class="nb">true</span><span class="p">,</span> <span class="c1">//use newton iteration</span>
                                          <span class="mf">5e-7</span><span class="p">,</span> <span class="c1">// tolerance</span>
                                          <span class="mi">5</span> <span class="c1">// number of max steps</span>
                                          <span class="p">);</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F_polar</span><span class="p">.</span><span class="n">R</span><span class="p">()</span><span class="o">*</span><span class="n">F_polar</span><span class="p">.</span><span class="n">U</span><span class="p">();</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">F_polar</span><span class="p">.</span><span class="n">V</span><span class="p">()</span><span class="o">*</span><span class="n">F_polar</span><span class="p">.</span><span class="n">R</span><span class="p">();</span>
</pre></div>
</div>
</p>
<p>The following derivatives are also important <div class="math">
<p><img src="../_images/math/663f9683ff48c1ea143fe084e651991e47f15526.svg" alt="\frac{\partial \SecondT{U}}{\partial \SecondT{F}}, \quad \frac{\partial \SecondT{V}}{\partial \SecondT{F}}, \quad \frac{\partial \SecondT{R}}{\partial \SecondT{F}}"/></p>
</div> explicit results are given <a class="reference external" href="https://doi.org/10.1023/A:1007663620943">here</a> <div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//use the spectral decomposition</span>
<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">F</span><span class="p">;</span>
<span class="n">F</span><span class="p">.</span><span class="n">randn</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">F_polar</span> <span class="o">=</span> <span class="n">tmech</span><span class="o">::</span><span class="n">polar_decomposition</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">dR</span> <span class="o">=</span> <span class="n">F_polar</span><span class="p">.</span><span class="n">R</span><span class="p">().</span><span class="n">derivative</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">dU</span> <span class="o">=</span> <span class="n">F_polar</span><span class="p">.</span><span class="n">U</span><span class="p">().</span><span class="n">derivative</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">dV</span> <span class="o">=</span> <span class="n">F_polar</span><span class="p">.</span><span class="n">V</span><span class="p">().</span><span class="n">derivative</span><span class="p">();</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><p><strong>_Tensor</strong> – Tensor object </p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>__tensor</strong> – Tensor expression, from which the polar decomposition is to be computed. </p></li>
<li><p><strong>__newton_method</strong> – True if Newton iteration should be used </p></li>
<li><p><strong>__tol</strong> – Tolerance for Newton iteration </p></li>
<li><p><strong>__max_steps</strong> – Maximum number of Newton iterations </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id1">
<h1>Exponential map<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<span class="target" id="exponential-map-func-ref"></span><dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E3expDaRR7_Tensor">
<span id="_CPPv3I00E3expRR7_Tensor"></span><span id="_CPPv2I00E3expRR7_Tensor"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_Tensor</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="tensor__functions__forward_8h_1ada7038a705b72395bdd95124ac02ebd4"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">exp</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E3expDaRR7_Tensor" title="exp::_Tensor"><span class="n"><span class="pre">_Tensor</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">__tensor</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E3expDaRR7_Tensor" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Exponential map of a nonsymmetric second order tensor. </p>
<p><div class="math">
<p><img src="../_images/math/4b44dc2e08b9ae90eb1da399298a54f2e7037678.svg" alt="\text{exp}\SecondT{A} = \sum_{n=0}^\infty \frac{1}{n!} \SecondT{A}^n"/></p>
</div></p>
<p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">{</span><span class="mf">9.064107e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.649874e-01</span><span class="p">,</span>  <span class="mf">4.431378e-01</span><span class="p">,</span>
                              <span class="mf">1.557860e+00</span><span class="p">,</span>  <span class="mf">2.493285e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.458549e-01</span><span class="p">,</span>
                              <span class="mf">1.747649e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.824761e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.110930e-01</span><span class="p">};</span>

<span class="n">tmech</span><span class="o">::</span><span class="n">tensor</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span><span class="n">Aexp</span><span class="p">{</span><span class="mf">2.333496383103521e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.424245337660712e-01</span><span class="p">,</span>   <span class="mf">6.174107765089896e-01</span><span class="p">,</span>
                                <span class="mf">2.458154759604529e+00</span><span class="p">,</span>   <span class="mf">7.615487934000856e-01</span><span class="p">,</span>   <span class="mf">1.403592316302926e-01</span><span class="p">,</span>
                                <span class="mf">1.701192794766057e+00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.849258234991792e-01</span><span class="p">,</span>   <span class="mf">8.233614408596337e-01</span><span class="p">};</span>

 <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span>
          <span class="o">&lt;&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">almost_equal</span><span class="p">(</span><span class="n">Aexp</span><span class="p">,</span> <span class="n">tmech</span><span class="o">::</span><span class="n">exp</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="mf">5e-7</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

 <span class="c1">//check the derivative</span>
 <span class="k">const</span> <span class="k">auto</span> <span class="n">func_exp</span> <span class="o">=</span> <span class="p">[](</span><span class="k">auto</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">tensor</span><span class="p">){</span><span class="k">return</span> <span class="n">tmech</span><span class="o">::</span><span class="n">exp</span><span class="p">(</span><span class="n">tensor</span><span class="p">);};</span>
 <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span>
          <span class="o">&lt;&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">almost_equal</span><span class="p">(</span><span class="n">tmech</span><span class="o">::</span><span class="n">num_diff_central</span><span class="o">&lt;</span><span class="n">tmech</span><span class="o">::</span><span class="n">sequence</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">func_exp</span><span class="p">,</span><span class="n">A</span><span class="p">),</span> <span class="n">tmech</span><span class="o">::</span><span class="n">exp</span><span class="p">(</span><span class="n">A</span><span class="p">).</span><span class="n">derivative</span><span class="p">(),</span> <span class="mf">5e-7</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
 </p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="numerical_diff.html" class="btn btn-neutral float-right" title="Numerical differentiation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tensor_as_array.html" class="btn btn-neutral float-left" title="Tensors as arrays" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Peter Lenz

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>